<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>product</title>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/easyui-lang-zh_CN.js"></script>
    <link type="text/css" rel="stylesheet" href="css/css.css">
    <link type="text/css" rel="stylesheet" href="css/easyui.css">
    <link type="text/css" rel="stylesheet" href="css/icon.css">
    <link rel="stylesheet" type="text/css" href="css/style.css" />
</head>

</head>
<body>

<!--展示数据-->

<div id="toolBar">
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-add" onclick="addE()"></a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-edit" onclick="updateE()"></a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-remove" onclick="deleteE()"></a>
</div>
<table id="showAllProduct">
    <div id="tb1">

        <input name="proName" id="ss1" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'所属产品名搜索'"></input>
        <input name="brandName" id="ss2" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'根据品牌名搜索'"></input>
        <input name="proStyleName" id="ss3" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'根据产品风格搜索'"></input>
        <input name="proTypeName" id="ss4" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'根据产品类型搜索'"></input>
        <input name="proSeriesName" id="ss5" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'根据产品系列搜索'"></input>
        <input name="proTextureName" id="ss6" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'根据产品材质搜索'"></input>
        <input name="proPositionName" id="ss7" class="easyui-searchbox" style="width:200px"
               data-options="searcher:search,prompt:'根据产品位置搜索'"></input>
    </div>

</table>
<script type="text/javascript">
    /*关键词搜索*/
    function search(value,name){

        var ca1 = $("#ss1").searchbox('getValue');
        var ca2 = $("#ss2").searchbox('getValue');
        var ca3 = $("#ss3").searchbox('getValue');
        var ca4 = $("#ss4").searchbox('getValue');
        var ca5 = $("#ss5").searchbox('getValue');
        var ca6 = $("#ss6").searchbox('getValue');
        var ca7 = $("#ss7").searchbox('getValue');

        alert(value+":"+name)
        $('#showAllProduct').datagrid({
            queryParams: {
                proName:ca1,
                brandName:ca2,
                proStyleName:ca3,
                proTypeName:ca4,
                proSeriesName:ca5,
                proTextureName:ca6,
                proPositionName:ca7,
            }

        });

    }
</script>

<!--添加产品-->
<div id="addProduct" class="easyui-dialog" data-options="closed:true">
    <form id="addProductInformation" enctype="multipart/form-data" method="post">
        <input name="proId" type="hidden"><br>
        产品名：<input name="proName" ><br>
        价格：<input name="proPrice"  ><br>
        位置：<input name="proPosition" ><br>
        风格：<input name="proStyle" ><br>
        类型：<input name="proType" ><br>
        系列：<input name="proSeries" ><br>
        材质：<input name="center" ><br>
        品牌：<input name="brand" ><br>
        型号：<input name="modleCode" ><br>
        尺寸：<input name="size" ><br>
        介绍：<input name="proMsg" ><br>
        浏览量<input name="pageViews"><br>
        网店地址：<input name="proSrc"><br>
        添加时间：<input name="proAddTime" ><br>
        修改时间：<input name="proUpdateTime" ><br>
        是否上架：<input name="proPutaway" ><br>
        图片：<input name="proImgs" ><br>
        Keyword：<input name="proMetaKeyWord"><br>
        Description：<input name="proMetaDescription" ><br>
        Title：<input name="proMetaTitle"><br>

        <center>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro1()">确认</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro2()"></a>
        </center>

    </form>
</div>
<!--修改meta标签内容-->
<div id="updateProduct" class="easyui-dialog" data-options="closed:true">
    <form id="updateProductInformation" enctype="multipart/form-data" method="post">
        <input name="proId" id="proId" type="hidden"><br>
        产品名：<input name="proName" id="proName"><br>
        价格：<input name="proPrice" id="proPrice"><br>
        位置：<input name="proPosition" id="proPosition"><br>
        风格：<input name="proStyle" id="proStyle"><br>
        类型：<input name="proType" id="proType"><br>
        系列：<input name="proSeries" id="proSeries"><br>
        材质：<input name="center" id="center"><br>
        品牌：<input name="brand" id="brand"><br>
        型号：<input name="modleCode" id="modleCode"><br>
        尺寸：<input name="size" id="size"><br>
        介绍：<input name="proMsg" id="proMsg"><br>
        浏览量：<input name="pageViews" id="pageViews"><br>
        网店地址：<input name="proSrc" id="proSrc"><br>
       <!-- 添加时间：<input name="proAddTime" id="proAddTime"><br>
        修改时间：<input name="proUpdateTime" id="proUpdateTime"><br>-->
        是否上架：<input name="proPutaway" id="proPutaway"><br>
        图片：<input name="proImgs" id="proImgs"><br>
        Keyword：<input name="proMetaKeyWord" id="proMetaKeyWord"><br>
        Description：<input name="proMetaDescription" id="proMetaDescription"><br>
        Title：<input name="proMetaTitle" id="proMetaTitle"><br>
        <center>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro2()">确认</a>
        </center>
    </form>

</div>
<script type="text/javascript">

    $(function () {

            $("#showAllProduct")
                .datagrid(
                    {
                        url: 'http://localhost:9999/visney-manager/product/getAll',
                        fitColumns: true,

                        columns: [[{
                            /* field: '',*/
                            checkbox: true
                        }, {
                            field: 'proId',
                            align: 'center',
                            title: 'Id',
                            width: 200,

                        }, {
                            field: 'proName',
                            align: 'center',
                            title: '产品名',
                            width: 200,

                        }, {
                            field: 'proPrice',
                            align: 'center',
                            title: '价格',
                            width: 200,

                        }, {
                            field: 'proPosition',
                            align: 'center',
                            title: '位置',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.proPositionName

                            }

                        }, {
                            field: 'proStyle',
                            align: 'center',
                            title: '风格',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.proStyleName

                            }

                        }, {
                            field: 'proType',
                            align: 'center',
                            title: '类型',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.proTypeName

                            }

                        }, {
                            field: 'proSeries',
                            align: 'center',
                            title: '系列',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.proSeriesName

                            }

                        }, {
                            field: 'proTexture',
                            align: 'center',
                            title: '材质',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.proTextureName

                            }

                        }, {
                            field: 'brand',
                            align: 'center',
                            title: '品牌',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.brandName

                            }

                        }, {
                            field: 'modleCode',
                            align: 'center',
                            title: '型号',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.modelCodeName

                            }

                        }, {
                            field: 'size',
                            align: 'center',
                            title: '尺寸',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.siziMsg

                            }

                        }, {
                            field: 'proMsg',
                            align: 'center',
                            title: '介绍',
                            width: 200,
                            formatter: function (value, row, index) {
                                if (value != null) {
                                    return value.replace(/<\/?.+?>/g, "").substring(0, 20)
                                }
                            }

                        }, {
                            field: 'pageViews',
                            align: 'center',
                            title: '浏览量',
                            width: 200,
                            formatter: function (value, row, index) {
                                return value.pageViewsCount

                            }


                        }, {
                            field: 'proSrc',
                            align: 'center',
                            title: '网店地址',
                            width: 200,

                        }, {
                            field: 'proAddTime',
                            align: 'center',
                            title: '添加时间',
                            width: 200,

                        }, {
                            field: 'proUpdateTime',
                            align: 'center',
                            title: '修改时间',
                            width: 200,

                        }, {
                            field: 'proPutaway',
                            align: 'center',
                            title: '是否上架',
                            width: 200,
                            formatter: function (value, row, index) {
                                // value  当前列值
                                // row 当前行对象
                                // index  行数据下标
                                if (value == 1) {
                                    return "是";

                                }
                                else {
                                    return "否";
                                }

                            }

                        }, {
                            field: 'proImgs',
                            align: 'center',
                            title: '封面图片',
                            width: 200,
                            formatter: function (value, row, index) {
                                // value  当前列值
                                // row 当前行对象
                                // index  行数据下标
                                if (value) {
                                    for (var i = 0; i < value.length; i++) {
                                        if (i == 0) {
                                            /* console.log(value[i].proImgSrc+"zzzzzzzzzzzzzzzzzzzz")*/
                                            return "<img width=50px height=50px src='" + value[i].proImgSrc + "'>";
                                        }
                                    }
                                }
                            }
                        }, {
                            field: 'proMetaKeyWord',
                            align: 'center',
                            title: 'Keyword',
                            width: 200,

                        }, {
                            field: 'proMetaDescription',
                            align: 'center',
                            title: 'Description',
                            width: 200,

                        }, {
                            field: 'proMetaTitle',
                            align: 'center',
                            title: 'Title',
                            width: 200,

                        }
                        ]],
                        striped: true,
                        pagination: true,
                        pageSize: 20,
                        /* pageList: [10,20,30,40],*/
                        toolbar: "#toolBar"

                    })

    })
    /*update*/
    //加载修改页面。。。。。。。。。。。。
    $(function(){
        $("#updateProduct").dialog({

            title:"修改页面",
            width:860,
            width:400,
            cache: false,
            closed:true,
            modal:true,
        })
    })

    //点击执行修改操作 显示修改页面
    function updateE(){
        //返回第一个被选中的行或如果没有选中的行则返回null。

        var vas=$("#showAllProduct").datagrid("getChecked");
        var va=$("#showAllProduct").datagrid("getSelected");
        if(vas.length>1||vas.length<1||vas==null){
            $.messager.alert("提示框","请选择一个要修改的数据","warming");
        }else{
            $("#updateSizeInformation input" ).val("");
            $("#updateProduct").dialog("open");
            $("#sizeId").val(va.sizeId);
            $("#siziMsg").val(va.siziMsg);
        }
    }
    //在修改页面 点击修改 修改
    function pro3(){
        //点击form表单 用ajax提交
        $("#updateProductInformation").form("submit",{
            url:"http://localhost:9999/visney-manager/size/updateSize",

            success:function(data){
                var da=eval('(' + data + ')');
                console.log(data)
                if(da.msg){
                    $.messager.alert("提示框"," 修改成功","info");//提示框
                    //关闭添加  对话框

                    $("#updateSize").dialog("close");

                    //表格重新加载
                    $("#showAllProduct").datagrid("reload");
                }else{
                    $.messager.alert("提示框","修改失败，请确认","warming");
                }
            }
        })
    }
    //点击取消 取消修改
    function pro4(){
        $("#updateSize").dialog("close");
    }
    /*添加界面开始*/
    //添加页面
    $(function(){
        $("#addProduct").dialog({
            title:"添加页面",
            width:860,
            height: 400,
            cache: false,
            closed:true,
            modal:true,
        });
    })
    //显示添加 页面
    function addE(){
        $("#addProduct").dialog("open");
    }
    //点击添加按钮添加
    function pro1(){
//              发送ajxs请求

        $("#addProductInformation").form('submit',{
            url:"http://localhost:9999/visney-manager/product/addSize",
            type:"post",
            success:function (data) {
                var da = eval('(' + data + ')');
                if(da.msg){
                    $.messager.alert("提示框","添加成功","info")
                    //	关闭对话框
                    $("#addProduct").dialog("close")
                    //表格重新加载
                    $("#showAllProduct").datagrid("reload");
                }else{
                    $.messager.alert("提示框","添加失败","warming");
                }
            }
        })
    }
    //点击取消按钮 取消添加
    function pro2(){
        $("#addProduct").dialog("close");
    }

    //点击删除按钮执行  删除操作
    function  deleteE(){
        var rows = $("#showAllProduct").datagrid("getSelections");//返回所有被选中的行，当没有记录被选中的时候将返回一个空数组。

        if(rows.length==0){
            $.messager.alert("提示框","请删除要选择的内容","warning");
        }else{
            $.messager.confirm("确认删除","确定要删除选中的所有内容吗？",function(r){
                if(r){
                    var ids = new Array();//创建一个数组
                    for(var i = 0;i<rows.length;i++){
                        ids[i]= rows[i].sizeId;//这里是（对象.属性）
                    }
                    $.ajax({
                        url:"http://localhost:9999/visney-manager/product/deleteSize",
                        type:"post",
                        data:"ids="+ids,//data:{"ids":ids}
                        success:function(data){
                            if(data.msg){
                                $.messager.alert("提示框","删除成功","info");//提示框
                                //关闭添加  对话框

                                $("#updateSize").dialog("close");

                                //表格重新加载
                                $("#showAllProduct").datagrid("reload");
                            }else{
                                $.messager.alert("提示框","删除失败，请确认","warming");
                            }
                        }
                    });

                }
            });
        }
    }

</script>
</body>



</html>