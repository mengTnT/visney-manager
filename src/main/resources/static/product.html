<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>product</title>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/easyui-lang-zh_CN.js"></script>
    <link type="text/css" rel="stylesheet" href="css/css.css">
    <link type="text/css" rel="stylesheet" href="css/easyui.css">
    <link type="text/css" rel="stylesheet" href="css/icon.css">
    <link rel="stylesheet" type="text/css" href="css/style.css" />
</head>

</head>
<body>
<!--展示数据-->
<table id="showAllProduct"></table>
<!--添加导航meta标签-->
<div id="addProduct" class="easyui-dialog" data-options="closed:true">
    <form id="addProductInformation" enctype="multipart/form-data" method="post">
        <!--<section id="wrap">
            <h1>图片拖拽上传示范</h1>
            <section class="area">
                <article id="upload" draggable="true">
                    <span></span>
                    <div class="file">选择图片<form id="form" runat="server" method="post" enctype="multipart/form-data" ><input type="file"  multiple="multiple" id="imges1" name="imges1" class="upimages" enctype="multipart/form-data"/></form></div>
                </article>
                <article id="drag">请将图片拖到此区域</article>
            </section>
            <section class="info">
                <p>已选中<span class="num" id='picLen'>0</span>张图片，共<span class="size" id='picSize'>0</span>MB</p>
                <article>
                    <div class="file">继续选择<input multiple="multiple" type="file" id="imges2" name="imges1" class="upimages" enctype="multipart/form-data"/></div>
                    <div class="upload" id='btn'>开始上传</div>
                </article>
            </section>
            <section class="list">
                <ul id="ul1">
                </ul>
            </section>
        </section>-->
        <input name="navigationName"><br>
        Title：<input name="navigationTitle"><br>
        Description：<input name="navigationDescription"><br>
        Keyword：<input name="navigationKeyword"><br>






        <center>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro1()">确认</a>
        </center>

    </form>
</div>
<!--修改meta标签内容-->
<div id="updateProduct" class="easyui-dialog" data-options="closed:true">
    <form id="updateProductInformation" enctype="multipart/form-data" method="post">

        <input name="proId" id="proId" type="hidden"><br>
        产品名：<input name="proName" id="proName"><br>
        价格：<input name="proPrice" id="proPrice"><br>
        位置：<input name="proPosition" id="proPosition"><br>
        风格：<input name="proStyle" id="proStyle"><br>
        类型：<input name="proType" id="proType"><br>
        系列：<input name="proSeries" id="proSeries"><br>
        材质：<input name="center" id="center"><br>
        品牌：<input name="brand" id="brand"><br>
        型号：<input name="modleCode" id="modleCode"><br>
        尺寸：<input name="size" id="size"><br>
        介绍：<input name="proMsg" id="proMsg"><br>
        浏览量：<input name="pageViews" id="pageViews"><br>
        网店地址：<input name="proSrc" id="proSrc"><br>
        添加时间：<input name="proAddTime" id="proAddTime"><br>
        修改时间：<input name="proUpdateTime" id="proUpdateTime"><br>
        是否上架：<input name="proPutaway" id="proPutaway"><br>
        图片：<input name="proImgSrc" id="proImgSrc"><br>
        Keyword：<input name="proMetaKeyWord" id="proMetaKeyWord"><br>
        Description：<input name="proMetaDescription" id="proMetaDescription"><br>
        Title：<input name="proMetaTitle" id="proMetaTitle"><br>

        <center>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro2()">确认</a>
        </center>
    </form>

</div>
<script type="text/javascript">
    $(function () {
        $("#showAllProduct")
            .datagrid(
                {
                    url: 'http://localhost:9999/visney-manager/product/getAll',
                    fitColumns: true,

                    columns: [[{
                        /* field: '',*/
                        checkbox: true
                    }, {
                        field: 'proId',
                        align: 'center',
                        title: 'Id',
                        width: 200,

                    },{
                        field: 'proName',
                        align: 'center',
                        title: '产品名',
                        width: 200,

                    },{
                        field: 'proPrice',
                        align: 'center',
                        title: '价格',
                        width: 200,

                    },{
                        field: 'proPosition',
                        align: 'center',
                        title: '位置',
                        width: 200,
                        formatter: function (value, row, index) {
                          return value.proPositionName

                        }

                    },{
                        field: 'proStyle',
                        align: 'center',
                        title: '风格',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.proStyleName

                        }

                    },{
                        field: 'proType',
                        align: 'center',
                        title: '类型',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.proTypeName

                        }

                    },{
                        field: 'proSeries',
                        align: 'center',
                        title: '系列',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.proSeriesName

                        }

                    },{
                        field: 'proTexture',
                        align: 'center',
                        title: '材质',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.proTextureName

                        }

                    },{
                        field: 'brand',
                        align: 'center',
                        title: '品牌',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.brandName

                        }

                    },{
                        field: 'modleCode',
                        align: 'center',
                        title: '型号',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.modelCodeName

                        }

                    },{
                        field: 'size',
                        align: 'center',
                        title: '尺寸',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.siziMsg

                        }

                    },{
                        field: 'proMsg',
                        align: 'center',
                        title: '介绍',
                        width: 200,
                        formatter: function (value, row, index) {
                            if(value!=null) {
                                return value.replace(/<\/?.+?>/g, "").substring(0, 20)
                            }
                        }

                    },{
                        field: 'pageViews',
                        align: 'center',
                        title: '浏览量',
                        width: 200,
                        formatter: function (value, row, index) {
                            return value.pageViewsCount

                        }


                    },{
                        field: 'proSrc',
                        align: 'center',
                        title: '网店地址',
                        width: 200,

                    },{
                        field: 'proAddTime',
                        align: 'center',
                        title: '添加时间',
                        width: 200,

                    },{
                        field: 'proUpdateTime',
                        align: 'center',
                        title: '修改时间',
                        width: 200,

                    },{
                        field: 'proPutaway',
                        align: 'center',
                        title: '是否上架',
                        width: 200,
                        formatter: function (value, row, index) {
                            // value  当前列值
                            // row 当前行对象
                            // index  行数据下标
                            if (value==1) {
                                return "是";

                            }
                            else{
                                return "否";
                            }

                        }

                    },{
                        field: 'proImgSrc',
                        align: 'center',
                        title: '图片',
                        width: 200,
                        formatter: function (value, row, index) {
                            // value  当前列值
                            // row 当前行对象
                            // index  行数据下标
                          //  return "<img width=50px height=50px src='" + value[i].proImgSrc + "'>";
                            if (value) {
                                for(var i=0;i<value.length;i++) {
                                    if(i==0) {
                                        return "<img width=50px height=50px src='" + value[i].proImgSrc + "'>";
                                    }
                                }
                            }

                        }

                    },{
                        field: 'proMetaKeyWord',
                        align: 'center',
                        title: 'Keyword',
                        width: 200,

                    },{
                        field: 'proMetaDescription',
                        align: 'center',
                        title: 'Description',
                        width: 200,

                    },{
                        field: 'proMetaTitle',
                        align: 'center',
                        title: 'Title',
                        width: 200,

                    }
                    ]],
                    striped: true,
                    pagination: true,
                    pageSize:20,
                    /* pageList: [10,20,30,40],*/
                    toolbar: [
                        {
                            iconCls: 'icon-add',
                            handler: function () {
                                $("#addProduct").dialog({
                                    title: '添加导航meta',
                                    width: 400,
                                    modal: true,
                                    closed: false
                                })

                            }
                        },
                        '-',
                        {
                            iconCls: 'icon-edit',
                            handler: function () {
                                var cates = $("#showAllProduct")
                                    .datagrid('getChecked');
                                if (cates.length > 1
                                    || cates.length < 1) {
                                    $.messager.alert("消息",
                                        "请选择一条数据修改", 'warning');
                                } else {
                                    $("#updateProduct").dialog(
                                        {
                                            title: '修改meta',
                                            width: 400,
                                            modal: true,
                                            closed: false,

                                        })
                                    var navigationId;
                                    var navigationName;
                                    var navigationTitle;
                                    var navigationDescription;
                                    var navigationKeyword;
                                    var navigationgetChecked = $("#showAllProduct").datagrid('getChecked');
                                    $.each(navigationgetChecked, function (index,
                                                                           cate) {
                                        console.log(cate)


                                        navigationId = cate.navigationId;
                                        navigationName = cate.navigationName;
                                        navigationTitle = cate.navigationTitle;
                                        navigationDescription = cate.navigationDescription;
                                        navigationKeyword = cate.navigationKeyword;

                                    })

                                    $("#navigationId").val(navigationId);
                                    $("#navigationName").val(navigationName);
                                    $("#navigationTitle").val(navigationTitle);
                                    $("#navigationDescription").val(navigationDescription);
                                    $("#navigationKeyword").val(navigationKeyword);

                                }
                            }
                        },
                        '-',
                        {
                            iconCls: 'icon-remove',
                            handler: function () {
                                var cates = $("#showAllProduct").datagrid('getChecked');
                                if (cates.length < 1) {
                                    $.messager.alert("消息", "请选择一条数据修改", 'warning');
                                } else {
                                    $.messager.confirm("消息", "您确定要删除吗？", function (x) {
                                        if (x) {
                                            var ids = [];
                                            var cateIds = $("#showAllProduct").datagrid('getChecked');
                                            $.each(cateIds, function (index, ii) {
                                                ids.push(ii.navigationId);
                                            })
                                            $.ajax({
                                                type: 'post',
                                                url: 'http://localhost:9999/visney-manager/NavigationMeta/metaDelete',
                                                data: 'ids=' + ids,
                                                success: function (data) {
                                                    if (data != 0) {
                                                        $.messager.alert("消息", "删除成功", 'info');
                                                        $("#showAllProduct").datagrid('reload');
                                                    } else {
                                                        $.messager.alert("消息", "删除失败", 'error');
                                                        $("#showAllProduct").datagrid('reload');
                                                    }
                                                }
                                            })
                                        } else {
                                            $("#showAllProduct").datagrid('reload');
                                        }
                                    })

                                }
                            }
                        }]

                })
    })


    $("#addProductInformation").submit(function () {
        var formData = new FormData($("#addProductInformation")[0]);
        $.ajax({
            type: 'post',
            url: 'http://localhost:9999/visney-manager/NavigationMeta/metaAdd',
            data: formData,
            contentType: false,
            processData: false,
            success: function (dada) {
                if (dada == 1) {
                    $.messager.alert("消息", "添加成功", 'info');
                    $("#addProduct").dialog('close');
                    $("#showAllProduct").datagrid('reload');

                } else if (dada == 0) {
                    $.messager.alert("消息", "添加失败", 'error');
                    $("#addProduct").dialog('close');
                    $("#showAllProduct").datagrid('reload');

                }
            }
        })
        return false;
    })
    $("#updateProductInformation").submit(function () {
        var formData = new FormData($("#updateProductInformation")[0]);
        $.ajax({
            type: 'post',
            url: 'http://localhost:9999/visney-manager/NavigationMeta/metaUpdate',
            data: formData,
            cache: false,
            contentType: false,
            processData: false,
            success: function (dada) {
                if (dada == 1) {
                    $.messager.alert("消息", "修改成功", 'info');
                    $("#updateProduct").dialog('close');
                    $("#showAllProduct").datagrid('reload');
                } else {
                    $.messager.alert("消息", "修改失败", 'error');
                    $("#updateProduct").dialog('close');
                    $("#showAllProduct").datagrid('reload');
                }
            }
        })
        return false;
    })


    function pro2() {
        $("#updateProductInformation").submit();
    }

    function pro1() {
        $("#addProductInformation").submit();
    }
</script>
</body>



</html>