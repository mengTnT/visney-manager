<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>article</title>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/easyui-lang-zh_CN.js"></script>
    <link type="text/css" rel="stylesheet" href="css/css.css">
    <link type="text/css" rel="stylesheet" href="css/easyui.css">
    <link type="text/css" rel="stylesheet" href="css/icon.css">
</head>

</head>
<body>

<table id="showAllProCategory"></table>

<div id="toolBar">
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-add" onclick="addE()"></a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-edit" onclick="updateE()"></a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-remove" onclick="deleteE()"></a>
</div>



<div id="updateProCategory" class="easyui-dialog" data-options="closed:true">
    <form id="updateProCategoryInformation" enctype="multipart/form-data" method="post">

        <input name="proCategoryId" id="proCategoryId" type="hidden"><br>
        类别名称：<input name="proCategoryName" id="proCategoryName" ><br>
        父级类别：<input name="parentId" id="parentId" ><br>


        <center>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro1()">确认</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro2()">放弃</a>

        </center>
    </form>

</div>
<div id="addProCategory" class="easyui-dialog" data-options="closed:true">
    <form id="addProCategoryInformation" enctype="multipart/form-data" method="post">

        <input name="sizeId"  type="hidden"><br>
        类别名称：<input name="proCategoryName"  ><br>
        父级类别：<input name="parentId"  ><br>

        <center>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro3()">确认</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-save" onClick="pro4()">放弃</a>

        </center>
    </form>

</div>

<script type="text/javascript">
    $(function () {
    /*分页 展示所有*/
        //1.2把table转换成一个datagrid效果
        $("#showAllProCategory").datagrid({
            url:"http://192.168.100.250:9999/visney-manager/proCategory/getAllProCategory",//请求路径
            //在底部显示分页工具栏，设置为true之后，datagrid再发生ajax的时候就会发送两个参数
            pagination:true,//如果为true，则在DataGrid控件底部显示分页工具栏。
            border:true,
            maximizable:true,

            toolbar:"#toolBar",//顶部添加工具栏
            columns:[[
                {checkbox: true},
                {title:"类别ID",field:"proCategoryId",width:200},//每一列是一个对象
                {title:"类别名称",field:"proCategoryName", width:200},
                {title:"父级类别",field:"parentId", width:200},
            ]],
        })

    })
/*update*/
    //加载修改页面。。。。。。。。。。。。
    $(function(){
        $("#updateProCategory").dialog({

            title:"修改页面",
            width:860,
            width:400,
            cache: false,
            closed:true,
            modal:true,
        })
    })

    //点击执行修改操作 显示修改页面
    function updateE(){
        //返回第一个被选中的行或如果没有选中的行则返回null。

        var va=$("#showAllProCategory").datagrid("getChecked");
        var vas=$("#showAllProCategory").datagrid("getSelected");
        if(va.length>1||va.length<1){
            $.messager.alert("提示框","请选择一个要修改的数据","warming");
        }else{
            $("#updateProCategoryInformation input").val("");
            $("#updateProCategory").dialog("open");
            $("#proCategoryId").val(vas.proCategoryId);
            $("#proCategoryName").val(vas.proCategoryName);
            $("#parentId").val(vas.parentId);
        }
    }
    //在修改页面 点击修改 修改
    function pro1(){
        //点击form表单 用ajax提交
        $("#updateProCategoryInformation").form("submit",{
            url:"http://192.168.100.250:9999/visney-manager/proCategory/updateProCategory",

            success:function(data){
                var da=eval('(' + data + ')');

                if(da.msg){
                    $.messager.alert("提示框"," 修改成功","info");//提示框
                    //关闭添加  对话框

                    $("#updateProCategory").dialog("close");

                    //表格重新加载
                    $("#showAllProCategory").datagrid("reload");
                }else{
                    $.messager.alert("提示框","修改失败，请确认","warming");
                }
            }
        })
    }
    //点击取消 取消修改
    function pro2(){
        $("#updateProCategory").dialog("close");
    }
    /*添加界面开始*/
    //添加页面
    $(function(){
        $("#addProCategory").dialog({
            title:"添加页面",
            width:860,
            height: 400,
            cache: false,
            closed:true,
            modal:true,
        });
    })
    //显示添加 页面
    function addE(){
        $("#addProCategory").dialog("open");
    }
    //点击添加按钮添加
    function pro3(){
//              发送ajxs请求

        $("#addProCategoryInformation").form('submit',{
            url:"http://192.168.100.250:9999/visney-manager/proCategory/addProCategory",
            type:"post",
            date:"json",
            success:function (data) {
                var da = eval('(' + data + ')');
                if(da.msg){
                    $.messager.alert("提示框","添加成功","info")
                    //	关闭对话框
                    $("#addProCategory").dialog("close")
                    //表格重新加载
                    $("#showAllProCategory").datagrid("reload");
                }else{
                    $.messager.alert("提示框","添加失败","warming");
                }
            }
        })
    }
    //点击取消按钮 取消添加
    function pro4(){
        $("#addProCategory").dialog("close");
    }

    //点击删除按钮执行  删除操作
    function  deleteE(){
        var rows = $("#showAllProCategory").datagrid("getSelections");//返回所有被选中的行，当没有记录被选中的时候将返回一个空数组。

        if(rows.length==0){
            $.messager.alert("提示框","请删除要选择的内容","warning");
        }else{
            $.messager.confirm("确认删除","确定要删除选中的所有内容吗？",function(r){
                if(r){
                    var ids = new Array();//创建一个数组
                    for(var i = 0;i<rows.length;i++){
                        ids[i]= rows[i].proCategoryId;//这里是（对象.属性）
                    }
                    $.ajax({
                        url:"http://192.168.100.250:9999/visney-manager/proCategory/deleteProCategorys",
                        type:"post",
                        data:"ids="+ids,//data:{"ids":ids}
                        success:function(data){

                            if(data.msg==true){
                                $.messager.alert("提示框"," 修改成功","info");//提示框
                                //关闭添加  对话框

                                $("#updateProCategory").dialog("close");

                                //表格重新加载
                                $("#showAllProCategory").datagrid("reload");
                            }else{
                                $.messager.alert("提示框","修改失败，请确认","warming");
                            }
                        }
                    });

                }
            });
        }
    }
</script>
</body>



</html>